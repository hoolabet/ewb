<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.ewb.mapper.OrderMapper">
	<insert id="payment">
		INSERT INTO payment_${url} (id, price)
		VALUES (#{id},#{price})
	</insert>
	<insert id="insertOrder">
		<selectKey keyProperty="payno" order="BEFORE" resultType="int">
			select
			ifnull(MAX(payno),1)
			from payment_${url}
		</selectKey>
		INSERT INTO order_${url} (payno,id, pno, b_quantity)
		VALUES (#{payno},#{id},#{pno},${b_quantity})
	</insert>
	
	<update id="updateQuan">
		UPDATE product_${url}
		SET 
		quantity = quantity - #{quantity},
		s_quantity = s_quantity + #{quantity}
		WHERE
		pno = #{pno}
	</update>
	
</mapper>